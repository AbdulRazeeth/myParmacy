'use strict'
const racks=[
    //Racks-1 container
    [
        //Shelf-1 Container
        [
            {
                medicineName:'med001',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med002',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:4,
            },
            {
                medicineName:'med003',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
        ],
        //shelf-2 container
        [
            {
                medicineName:'med004',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:1,
            },
            {
                medicineName:'med005',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:5,
            },
            {
                medicineName:'med006',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:4,
            },
        ],
        //shelf-3 container
        [
            {
                medicineName:'med007',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:6,
            },
            {
                medicineName:'med008',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:7,
            },
            {
                medicineName:'med009',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:9,
            },
        ]
    ],
    //rack-2 container
    [
        //Shelf-1 Container
        [
            {
                medicineName:'med010',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:1,
            },
            {
                medicineName:'med011',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med012',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:4,
            },
        ],
        //shelf-2 container
        [
            {
                medicineName:'med013',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:9,
            },
            {
                medicineName:'med014',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med015',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:1,
            },
        ],
        //shelf-3 container
        [
            {
                medicineName:'med016',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:6,
            },
            {
                medicineName:'med017',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:7,
            },
            {
                medicineName:'med018',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:12,
            },
        ]
    ],
    //rack-3 container
    [
        //Shelf-1 Container
        [
            {
                medicineName:'med019',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:1,
            },
            {
                medicineName:'med020',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med021',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
        ],
        //shelf-2 container
        [
            {
                medicineName:'med022',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:1,
            },
            {
                medicineName:'med023',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:8,
            },
            {
                medicineName:'med024',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:13,
            },
        ],
        //shelf-3 container
        [
            {
                medicineName:'med025',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med026',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:9,
            },
            {
                medicineName:'med027',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:7,
            },
        ]
    ],
    //rack-4 container
    [
        //Shelf-1 Container
        [
            {
                medicineName:'med028',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:6,
            },
            {
                medicineName:'med029',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:5,
            },
            {
                medicineName:'med030',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:4,
            },
        ],
        //shelf-2 container
        [
            {
                medicineName:'med031',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
            {
                medicineName:'med032',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med033',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:1,
            },
        ],
        //shelf-3 container
        [
            {
                medicineName:'med034',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:10,
            },
            {
                medicineName:'med035',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:11,
            },
            {
                medicineName:'med036',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:7,
            },
        ]
    ],
    //rack-5 container
    [
        //Shelf-1 Container
        [
            {
                medicineName:'med037',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:9,
            },
            {
                medicineName:'med038',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
            {
                medicineName:'med039',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:14,
            },
        ],
        //shelf-2 container
        [
            {
                medicineName:'med040',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:12,
            },
            {
                medicineName:'med041',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:11,
            },
            {
                medicineName:'med042',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:12,
            },
        ],
        //shelf-3 container
        [
            {
                medicineName:'med043',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:16,
            },
            {
                medicineName:'med044',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:8,
            },
            {
                medicineName:'med045',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
        ]
    ],
    //rack-6 container
    [
        //Shelf-1 Container
        [
            {
                medicineName:'med046',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:1,
            },
            {
                medicineName:'med047',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med048',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:10,
            },
        ],
        //shelf-2 container
        [
            {
                medicineName:'med049',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:4,
            },
            {
                medicineName:'med050',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:5,
            },
            {
                medicineName:'med051',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
        ],
        //shelf-3 container
        [
            {
                medicineName:'med052',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:4,
            },
            {
                medicineName:'med053',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:8,
            },
            {
                medicineName:'med054',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:6,
            },
        ]
    ],
    //rack-7 container
    [
        //Shelf-1 Container
        [
            {
                medicineName:'med055',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:5,
            },
            {
                medicineName:'med056',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:8,
            },
            {
                medicineName:'med057',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
        ],
        //shelf-2 container
        [
            {
                medicineName:'med058',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med059',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:16,
            },
            {
                medicineName:'med060',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:5,
            },
        ],
        //shelf-3 container
        [
            {
                medicineName:'med061',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
            {
                medicineName:'med062',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:1,
            },
            {
                medicineName:'med063',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
        ]
    ],
    //rack-8 container
    [
        //Shelf-1 Container
        [
            {
                medicineName:'med064',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:10,
            },
            {
                medicineName:'med065',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:16,
            },
            {
                medicineName:'med066',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:13,
            },
        ],
        //shelf-2 container
        [
            {
                medicineName:'med067',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:5,
            },
            {
                medicineName:'med068',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:9,
            },
            {
                medicineName:'med069',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:8,
            },
        ],
        //shelf-3 container
        [
            {
                medicineName:'med070',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:3,
            },
            {
                medicineName:'med071',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:2,
            },
            {
                medicineName:'med072',
                totalCapacity:100,
                currentQuantity:100,
                pricePerUnit:12,
            },
        ]
    ],
]
let activeRack
let totalPrice
let availability
let totalPriceUpdate = document.getElementById('price')
let showBiller = document.getElementById('billing-menu')
let medicineName =  document.getElementById('med-name')
let totalCapacity = document.getElementById('total-cap')
let availableQuantity = document.getElementById('avai-quan')
let pricePerUnit = document.getElementById('price-unit')
let numberOfQuantity
let result
let way = document.getElementById('pathWay')
let selectedRack
let selectedShelf
let selectedContainer
let searchValue
let viewSelector = document.querySelector('#content')
let toHighLight
let activeShelf
let activeContainer
let dynamic
let medListArr =[]
let showRack = 0
let cssVariableSelector = document.querySelector(':root')
let tableDetail
function search(value){
    searchValue = document.getElementById('input-value').value.toLowerCase() || clickValue
    for(let i=0; i<value.length; i++){
        for(let j=0; j<value[i].length; j++){
            for(let k=0; k<value[i][j].length;k++){
                if(searchValue === value[i][j][k].medicineName){
                     result = `The medicine is in Rack-${i+1} of shelf-${j+1} of container-${k+1}`
                    selectedRack = value[i]
                    showRack = i
                    selectedShelf = value[i][j]
                    selectedContainer = value[i][j][k]
                    activeRack = viewSelector.children[i]
                    console.log(activeRack)
                    if(dynamic){
                        document.getElementById(dynamic).classList.remove('high-light-color')
                    }
                    cssVariableSelector.style.setProperty('--selectedRack',`${i}`)      
                    activeContainer =`${i}${j}container${k+1}`
                    document.getElementById(activeContainer).classList.add('high-light-color')
                    dynamic = activeContainer
                    clear()
                    pathWay(result)
                    medicineDetail(selectedContainer)
                }
            }
        }
    }
}
function clear(){
    document.getElementById('input-value').value = '';
    document.getElementById('quantity').value = '';
    document.getElementById('price').innerHTML = '';
}
function next(value){
    showRack = value+1
    cssVariableSelector.style.setProperty('--selectedRack',`${value+1}`)
}
function previous(value){
    showRack = value-1
    cssVariableSelector.style.setProperty('--selectedRack',`${value-1}`)
}
function pathWay(value){
    way.innerHTML = value
}
function medicineDetail(value){
    console.log(value)
    medicineName.innerHTML = value.medicineName;
    totalCapacity.innerHTML = value.totalCapacity;
    availableQuantity.innerHTML = value.currentQuantity;
    pricePerUnit.innerHTML = value.pricePerUnit;
}
function showBillingMenu(){
    showBiller.classList.remove('hide')
}
function notification(value){
    if(value<30){
        document.getElementById(activeContainer).classList.remove('high-light-Color')
        document.getElementById(activeContainer).classList.add('blink')
    }
}
function billing(selectedContainer){
    numberOfQuantity =document.getElementById('quantity').value;
    if(numberOfQuantity > 100 || numberOfQuantity <= 0){
        alert('Enter the valid Quantity(1-100) to bill')
        return
    }
    availability = selectedContainer.currentQuantity - numberOfQuantity;
    selectedContainer.currentQuantity = availability;
    medicineDetail(selectedContainer)
    totalPrice = numberOfQuantity*selectedContainer.pricePerUnit
    totalPriceUpdate.innerHTML = totalPrice
    notification(availability)
}
function rackGenerator(value){
    for (let i=0; i<value.length; i++){
        let rack =document.createElement('div')
        rack.id = 'rack'+(i+1)
        rack.className ='scene layer-'+(i+1);
        let cuboid = document.createElement('div')
        cuboid.className = 'cuboid rack-'+(i+1)
        let front = document.createElement('div')
        front.className = 'front cuboid-common-face'
        cuboid.appendChild(front)
        let shelfLength = value[i]
        for(let j=0; j<shelfLength.length; j++){
            let shelf =document.createElement('div')
            shelf.className = 'shelf'
            shelf.id = i+'shelf-'+(j+1)
            let container = shelfLength[j]
            for(let k=0; k<container.length; k++){
                let tabletContainer = document.createElement('div')
                tabletContainer.className = 'container'
                tabletContainer.id = `${i}${j}container${k+1}`
                tabletContainer.innerHTML = value[i][j][k].medicineName
                shelf.appendChild(tabletContainer)
            }
            front.appendChild(shelf)
    }
    cuboid.appendChild(front)
    let back = document.createElement('div')
    back.className ='back cuboid-common-face rack-background'
    cuboid.appendChild(back)
    let right = document.createElement('div')
    right.className ='right cuboid-common-face rack-background'
    cuboid.appendChild(right)
    let left = document.createElement('div')
    left.className ='left cuboid-common-face rack-background'
    cuboid.appendChild(left)
    let top = document.createElement('div')
    top.className ='top cuboid-common-face rack-background'
    cuboid.appendChild(top)
    let bottom = document.createElement('div')
    bottom.className ='bottom cuboid-common-face rack-background'
    cuboid.appendChild(bottom)
    rack.appendChild(cuboid)
    document.getElementById('content').appendChild(rack)
}
}
rackGenerator(racks)
function takeMedicine(value){
    for(let a=0; a<value.length; a++){
        for(let b=0; b<value[a].length; b++){
            for(let c=0; c<value[a][b].length; c++){
                medListArr.push(value[a][b][c])
            }
        }
    }
}
function tableGenerator(value){
    document.getElementById('table-container').innerHTML =''
    let tableHeader = document.createElement('div')
    tableHeader.className ='detail show-scroll'
    let headerOne = document.createElement('div')
    headerOne.id = 'medicine'
    headerOne.className = 'table-header-style'
    tableHeader.appendChild(headerOne)
    let headerTwo = document.createElement('div')
    headerTwo.id = 'med-quantity'
    headerTwo.className ='table-header-style'
    tableHeader.appendChild(headerTwo)
    document.getElementById('table-container').appendChild(tableHeader);
    document.getElementById('medicine').innerHTML = 'Medicine Name'
    document.getElementById('med-quantity').innerHTML = 'Available Quantity'
            for(let o=0; o<value.length; o++){
                let tableBody = document.createElement('div')
                tableBody.className ='table-body'
                tableDetail = document.createElement('div')
                tableDetail.className ='detail'
                let medicine = document.createElement('div')
                medicine.id = `medicine${o+1}`
                medicine.setAttribute('onclick','select(this.id)')
                tableDetail.appendChild(medicine)
                let count =document.createElement('div')
                count.id = `quantity${o+1}`
                tableDetail.appendChild(count)
                tableBody.appendChild(tableDetail)
                document.getElementById('table-container').appendChild(tableBody)
                document.getElementById(`medicine${o+1}`).innerHTML = value[o].medicineName
                document.getElementById(`quantity${o+1}`).innerHTML = value[o].currentQuantity
            }
}
let clickValue
function select(clicked_id){
    clickValue = document.getElementById(clicked_id).innerHTML
    searchValue = clickValue
    console.log(clickValue)
    search(racks)
}
function closeMedicineList(){
    document.getElementById('table-container').innerHTML = ''
}
function sortAscending(){
    medListArr.sort(function(a,b){
        return a.currentQuantity - b.currentQuantity
    })
    console.log(medListArr)
    tableGenerator(medListArr)
}
function sortDescending(){
    medListArr.sort(function(a,b){
        return b.currentQuantity - a.currentQuantity
    })
    console.log(medListArr)
    tableGenerator(medListArr)
}
takeMedicine(racks)



